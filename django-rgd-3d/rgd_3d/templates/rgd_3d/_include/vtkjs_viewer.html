{% block vtkjs_viewer %}
  {% load static %}

  <div id="vtkContainer"></div>

  <style>
  .progress {
    color: black;
    z-index: 100;
    background: rgba(128,128,128,.5);
    padding: 100px;
    border-radius: 10px;
    user-select: none;
    width: 25%;
    text-align: center;
    margin: 20% auto;
    position: relative;
    }
  </style>

  <div class="progress" id="progressContainer">
    <h1>Loading...</h1>
  </div>

  <script src="{% static 'rgd_3d/vtkjs_viewer.js' %}"></script>

  <script type="text/javascript">
    const progressContainer = document.getElementById('progressContainer');
    progressContainer.innerHTML = 'Loading...';

    console.log("{% static 'rgd_3d/index_bundle.js' %}")

    // console.log(vtk.Rendering.OpenGL.vtkRenderWindow.newInstance().getGLInformations())
    const vtkContainer = document.getElementById("vtkContainer")

    function load (container, urls) {
      emptyContainer(container);

      if (urls) {
        createViewer(container);
        let count = urls.length;
        while (count--) {
          fetch(urls[count])
            .then((resp) => resp.json())
            .then(function(data) {
              createPipeline(data.vtp_data)
            })
            .catch(function(error) {
              console.log(`Error loading data: ${error}`)
            });
        }
        updateCamera(renderer.getActiveCamera());
      }

      progressContainer.style.display = 'none'
    }


  </script>

{% endblock %}
